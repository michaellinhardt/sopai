# Fact Check: Ralph Loop Idempotency and Crash Recovery

## Claim

> Ralph loops are idempotent by design, allowing crash recovery by simply restarting the loop which re-reads state from disk.

## Sources Found

### Primary Sources

1. **[Ralph Playbook (GitHub)](https://github.com/ClaytonFarr/ralph-playbook)** - Comprehensive guide to Ralph methodology
   - States: "The IMPLEMENTATION_PLAN.md file persists on disk between iterations and acts as shared state between otherwise isolated loop executions."
   - States: "Each iteration deterministically loads the same files (PROMPT.md + AGENTS.md + specs/*) and reads the current state from disk."
   - States: "No sophisticated orchestration needed - just a dumb bash loop that keeps restarting the agent, and the agent figures out what to do next by reading the plan file each time."

2. **[Alibaba Cloud - From ReAct to Ralph Loop](https://www.alibabacloud.com/blog/from-react-to-ralph-loop-a-continuous-iteration-paradigm-for-ai-agents_602799)** - Technical analysis
   - States: "Continuously input the same prompt, allowing the AI to see its previous work results"
   - States: "Each round of the loop can be seen as a brand new session, with the agent no longer reading states from bloated history records"
   - States: "This design shifts state management from token-based memory to disk-based persistence."

3. **[Geoffrey Huntley - Ralph Wiggum](https://ghuntley.com/ralph/)** - Original concept creator
   - Describes Ralph as "a Bash loop" with the core pattern: `while :; do cat PROMPT.md | claude-code ; done`
   - Emphasizes "eventual consistency" approach

4. **[Paddo.dev - Ralph Wiggum Autonomous Loops](https://paddo.dev/blog/ralph-wiggum-autonomous-loops/)** - Technical deep-dive
   - States: "A Stop hook intercepts Claude's exit, re-feeds the original prompt."
   - Notes that progress persists through git history and file modifications

5. **[Sid Bharath - Ralph Wiggum Claude Code](https://sidbharath.com/blog/ralph-wiggum-claude-code/)** - Implementation guide
   - States: "The key insight is that Claude's previous work persists in the filesystem. Each iteration sees the code changes, git commits, and any notes from prior runs."
   - States: "The context window resets between iterations, but the code doesn't"

### Secondary Sources

6. **[GitHub - snarktank/ralph](https://github.com/snarktank/ralph)** - Implementation repository
   - States: "Each iteration is a fresh Amp instance with clean context. Memory persists via git history, progress.txt, and prd.json."

## Verdict

**PARTIALLY TRUE**

## Analysis

### What Is Accurate

1. **State Persistence on Disk**: Multiple sources confirm that Ralph loops persist state to the filesystem (IMPLEMENTATION_PLAN.md, progress.txt, prd.json, git history). This is a core design principle.

2. **Re-reading State on Restart**: Each iteration deterministically loads the same prompt files and reads current state from disk. This is well-documented across sources.

3. **Crash Recovery Through Restart**: The design allows recovery by restarting the bash loop, which spawns a fresh agent instance that reads the current filesystem state.

### What Is Exaggerated or Imprecise

1. **"Idempotent by Design"**: This phrasing overstates the formal guarantees. Ralph does not implement explicit idempotency safeguards (checksums, transaction logs, deduplication mechanisms). Instead, it relies on:
   - The agent inspecting task completion markers in plan files
   - Git history showing what was already committed
   - Human-readable progress files

2. **No Formal Crash Recovery Mechanism**: There is no crash recovery "system" - just the natural consequence of filesystem persistence and the bash loop's infinite retry pattern. If a crash occurs mid-file-write, there are no transaction semantics or rollback mechanisms.

3. **Idempotency Is Behavioral, Not Architectural**: The idempotent-like behavior emerges from the agent's ability to read what has been completed and skip it, not from a formal architectural guarantee. A poorly-written prompt could cause duplicate work.

### Key Distinction

Ralph's design is better described as **"recoverable through state inspection"** rather than **"idempotent by design."** True idempotency would mean re-running the same operation produces identical results without side effects. Ralph achieves resilience through a different mechanism: each fresh iteration assesses current state and determines remaining work.

### Supporting Evidence

The Alibaba Cloud article's framing is most accurate: "This approach makes Ralph loops fundamentally resilient to interruptions and crashes since all work is externalized to the filesystem." This describes resilience through externalized state, not formal idempotency.

The ralph-orchestrator extension (mentioned as adding "git checkpointing") suggests the base Ralph pattern lacks built-in recovery features, which are added by community extensions.
